<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:security="http://www.springframework.org/schema/security"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security.xsd">

    <!--<security:http pattern="/resources/**" security="none" />-->

    <security:http pattern="/login" security="none"/>

    <!--Customer-->
    <security:http use-expressions="true" pattern="/client/**" authentication-manager-ref="customerAuthMgr">
        <security:intercept-url pattern="/client/login" access="permitAll"/>
        <security:intercept-url pattern="/client/auth" access="permitAll"/>
        <security:intercept-url pattern="/client/**" access="hasRole('ROLE_CLIENT') || hasRole('ROLE_ADMIN')"/>

        <security:form-login
                login-processing-url="/client/login"
                login-page="/client/auth"
                authentication-failure-url="/client/auth?error=true"
                default-target-url="/home"
                always-use-default-target="false" />

        <security:logout logout-url="/logout" logout-success-url="/index"/>
    </security:http>

    <security:authentication-manager id="customerAuthMgr">
        <!--<security:authentication-provider user-service-ref="customerDetailsService"/>-->
        <security:authentication-provider>
            <security:user-service>
                <security:user name="user" password="user" authorities="ROLE_CLIENT" />
                <security:user name="admin" password="admin" authorities="ROLE_ADMIN" />
            </security:user-service>
        </security:authentication-provider>
    </security:authentication-manager>

    <!--<bean id="customerDetailsService" class="com.javastudy.deliveryservice.security.AuthCustomerBaseDetailsService"/>-->

    <!--Operator-->
    <security:http use-expressions="true" pattern="/operator/**" authentication-manager-ref="operatorAuthMgr">
        <security:intercept-url pattern="/operator/login" access="permitAll"/>
        <security:intercept-url pattern="/operator/auth" access="permitAll"/>
        <security:intercept-url pattern="/operator/**" access="hasRole('ROLE_OPERATOR') || hasRole('ROLE_ADMIN')"/>

        <security:form-login
                login-processing-url="/operator/login"
                login-page="/operator/auth"
                authentication-failure-url="/operator/auth?error=true"
                default-target-url="/home"
                always-use-default-target="false" />

        <security:logout logout-url="/logout" logout-success-url="/index"/>
    </security:http>

    <security:authentication-manager id="operatorAuthMgr">
        <!--<security:authentication-provider user-service-ref="operatorDetailsService"/>-->
        <security:authentication-provider>
            <security:user-service>
                <security:user name="user" password="user" authorities="ROLE_OPERATOR" />
                <security:user name="admin" password="admin" authorities="ROLE_ADMIN" />
            </security:user-service>
        </security:authentication-provider>
    </security:authentication-manager>

    <!--<bean id="operatorDetailsService" class="com.javastudy.deliveryservice.security.AuthOperatorDetailsService"/>-->


    <!--&lt;!&ndash;Courier&ndash;&gt;-->
    <!--<security:http use-expressions="true" pattern="/courier/**" authentication-manager-ref="courierAuthMgr">-->
        <!--<security:intercept-url pattern="/login*" access="permitAll"/>-->
        <!--<security:intercept-url pattern="/courier/auth" access="permitAll"/>-->
        <!--&lt;!&ndash;<security:intercept-url pattern="/courier/**" access="hasRole('ROLE_COURIER')"/>&ndash;&gt;-->

        <!--<security:form-login-->
                <!--login-processing-url="/login"-->
                <!--login-page="/courier/auth"-->
                <!--authentication-failure-url="/courier/auth?error=true"-->
                <!--default-target-url="/home"-->
                <!--always-use-default-target="false" />-->

        <!--<security:logout logout-url="/logout" logout-success-url="/index"/>-->
    <!--</security:http>-->

    <!--<security:authentication-manager id="courierAuthMgr">-->
        <!--&lt;!&ndash;<security:authentication-provider user-service-ref="courierDetailsService"/>&ndash;&gt;-->
        <!--<security:authentication-provider>-->
            <!--<security:user-service>-->
                <!--<security:user name="user" password="user" authorities="ROLE_CLIENT" />-->
            <!--</security:user-service>-->
        <!--</security:authentication-provider>-->
    <!--</security:authentication-manager>-->


</beans>